---
title: 读《大话设计模式》之工厂方法模式
date: 2017/2/11 20:46:25
updated: 2017/9/12 20:46:25
categories:
- 设计模式
- 《大话设计模式》
tags:
- 设计模式
- 《大话设计模式》
---

# 一、模式概述：

__定义一个用于创建对象的接口，让子类决定实例化哪一个类。工厂方法是一个类的实例化延迟到其子类。__

## UML图：

![工厂方法模式结构图](/assert/img/designmodel/justtalk/factorymethod/factorymethod-1.png)


![工厂方法模式实现](/assert/img/designmodel/justtalk/factorymethod/factorymethod-2.png)

* 抽象工厂角色： 这是工厂方法模式的核心，它与应用程序无关。是具体工厂角色必须实现的接口或者必须继承的父类。在java中它由抽象类或者接口来实现。

* 具体工厂角色：它含有和具体业务逻辑有关的代码。由应用程序调用以创建对应的具体产品的对象。在java中它由具体的类来实现。

* 抽象产品角色：它是具体产品继承的父类或者是实现的接口。在java中一般有抽象类或者接口来实现。

* 具体产品角色：具体工厂角色所创建的对象就是此角色的实例。在java中由具体的类来实现。

__这样整个工厂和具体的产品都没有修改的变化，只有扩展的变化，这就完全符合了开闭原则。__


# 二、模式优缺点：

## 优点：
克服了简单工厂违背开放-封闭原则的缺点，又保留了封装对象创建过程的优点,降低客户端和工厂的耦合性，所以说“工厂模式”是“简单工厂模式”的进一步抽象和推广。

## 缺点：
每增加一个产品，相应的也要增加一个子工厂，加大了额外的开发量。

# 三、模式适用场景：
* 情况一：如果一个对象拥有很多子类，那么创建该对象的子类使用工厂模式是最合适的，不但可以面向接口的编程，为维护以及开发带来方便。 
* 情况二：如果创建某个对象时需要进行许多额外的操作，如查询数据库然后将查询到的值赋予要创建的对象(单例初始化时使用比较多),或是需要许多额外的赋值等等。如果查看JDK源码中，会发现许多成员变量在对象构造时，通过工厂方法进行创建的。因为这些成员变量本身的创建也很复杂。不可能创建对象时，在该对象的构造方法里创建成员变量然后再赋值给该成员变量。而且使用工厂模式也提高了代码的重用性。 

# 四、模式总结：
对简单工厂模式的进一步抽象和封装。在简单工厂的基础上多抽象了一个工厂父类，用来生成不同的工厂类。工厂方法把简单工厂的内部逻辑判断迁移到了客户端来进行。
__使用工厂方法模式足以应付我们可能遇到的大部分业务需求。但是当产品种类非常多时，就会出现大量的与之对应的工厂类，这不应该是我们所希望的。所以我建议在这种情况下使用[简单工厂模式](/2016/01/22/读《大话设计模式》之简单工厂模式/index.html#一、模式概述：)与工厂方法模式相结合的方式来减少工厂类：即对于产品树上类似的种类（一般是树的叶子中互为兄弟的）使用[简单工厂模式](/2016/01/22/读《大话设计模式》之简单工厂模式/index.html#一、模式概述：)来实现。
当然特殊的情况，就要特殊对待了：对于系统中存在不同的产品树，而且产品树上存在产品族（下一节将解释这个名词）。那么这种情况下就可能可以使用[抽象工厂模式](/2016/03/10/读《大话设计模式》之抽象工厂模式/index.html#一、模式概述：)了。__